(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.ES6Promise=b()})(this,function(){'use strict';function a(a){var b=typeof a;return null!==a&&('object'==b||'function'==b)}function b(a){return'function'==typeof a}function c(){return'undefined'==typeof G?d():function(){G(e)}}function d(){var a=setTimeout;return function(){return a(e,1)}}function e(){for(var a=0;a<F;a+=2){var b=O[a],c=O[a+1];b(c),O[a]=void 0,O[a+1]=void 0}F=0}function f(a,b){var c=this,d=new this.constructor(h);void 0===d[Q]&&z(d);var e=c._state;if(e){var f=arguments[e-1];I(function(){return w(e,d,f,c._result)})}else t(c,d,a,b);return d}function g(a){var b=this;if(a&&'object'==typeof a&&a.constructor===b)return a;var c=new b(h);return p(c,a),c}function h(){}function i(){return new TypeError('You cannot resolve a promise with itself')}function j(){return new TypeError('A promises callback cannot return that same promise.')}function k(a){try{return a.then}catch(a){return R.error=a,R}}function l(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function m(a,b,c){I(function(a){var d=!1,e=l(c,b,function(c){d||(d=!0,b===c?r(a,c):p(a,c))},function(b){d||(d=!0,s(a,b))},'Settle: '+(a._label||' unknown promise'));!d&&e&&(d=!0,s(a,e))},a)}function n(a,b){1===b._state?r(a,b._result):2===b._state?s(a,b._result):t(b,void 0,function(b){return p(a,b)},function(b){return s(a,b)})}function o(a,c,d){c.constructor===a.constructor&&d===f&&c.constructor.resolve===g?n(a,c):d===R?(s(a,R.error),R.error=null):void 0===d?r(a,c):b(d)?m(a,c,d):r(a,c)}function p(b,c){b===c?s(b,i()):a(c)?o(b,c,k(c)):r(b,c)}function q(a){a._onerror&&a._onerror(a._result),u(a)}function r(a,b){void 0!==a._state||(a._result=b,a._state=1,0!==a._subscribers.length&&I(u,a))}function s(a,b){void 0!==a._state||(a._state=2,a._result=b,I(q,a))}function t(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+1]=c,e[f+2]=d,0===f&&a._state&&I(u,a)}function u(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?w(c,d,e,f):e(f);a._subscribers.length=0}}function v(a,b){try{return a(b)}catch(a){return R.error=a,R}}function w(a,c,d,e){var f,g,h,i,k=b(d);if(!k)f=e,h=!0;else if(f=v(d,e),f===R?(i=!0,g=f.error,f.error=null):h=!0,c===f)return void s(c,j());void 0!==c._state||(k&&h?p(c,f):i?s(c,g):1===a?r(c,f):2===a&&s(c,f))}function x(a,b){try{b(function(b){p(a,b)},function(b){s(a,b)})}catch(b){s(a,b)}}function y(){return S++}function z(a){a[Q]=S++,a._state=void 0,a._result=void 0,a._subscribers=[]}function A(){return new Error('Array Methods must be provided an Array')}function B(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor')}function C(){throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.')}var D=Array.isArray?Array.isArray:function(a){return'[object Array]'===Object.prototype.toString.call(a)};var E=D,F=0,G=void 0,H=void 0,I=function(a,b){O[F]=a,O[F+1]=b,F+=2,2==F&&(H?H(e):P())},J='undefined'==typeof window?void 0:window,K=J||{},L=K.MutationObserver||K.WebKitMutationObserver,M='undefined'==typeof self&&'undefined'!=typeof process&&'[object process]'==={}.toString.call(process),N='undefined'!=typeof Uint8ClampedArray&&'undefined'!=typeof importScripts&&'undefined'!=typeof MessageChannel,O=Array(1e3),P=void 0;P=M?function(){return function(){return process.nextTick(e)}}():L?function(){var a=0,b=new L(e),c=document.createTextNode('');return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}():N?function(){var a=new MessageChannel;return a.port1.onmessage=e,function(){return a.port2.postMessage(0)}}():void 0===J&&'function'==typeof require?function(){try{var a=Function('return this')().require('vertx');return G=a.runOnLoop||a.runOnContext,c()}catch(a){return d()}}():d();var Q=Math.random().toString(36).substring(2),R={error:null},S=0,T=function(){function a(a,b){this._instanceConstructor=a,this.promise=new a(h),this.promise[Q]||z(this.promise),E(b)?(this.length=b.length,this._remaining=b.length,this._result=Array(this.length),0===this.length?r(this.promise,this._result):(this.length=this.length||0,this._enumerate(b),0===this._remaining&&r(this.promise,this._result))):s(this.promise,A())}return a.prototype._enumerate=function(a){for(var b=0;void 0===this._state&&b<a.length;b++)this._eachEntry(a[b],b)},a.prototype._eachEntry=function(a,b){var d=this._instanceConstructor,c=d.resolve;if(c===g){var e=k(a);if(e===f&&void 0!==a._state)this._settledAt(a._state,b,a._result);else if('function'!=typeof e)this._remaining--,this._result[b]=a;else if(d===U){var i=new d(h);o(i,a,e),this._willSettleAt(i,b)}else this._willSettleAt(new d(function(b){return b(a)}),b)}else this._willSettleAt(c(a),b)},a.prototype._settledAt=function(a,b,c){var d=this.promise;void 0===d._state&&(this._remaining--,2===a?s(d,c):this._result[b]=c),0===this._remaining&&r(d,this._result)},a.prototype._willSettleAt=function(a,b){var c=this;t(a,void 0,function(a){return c._settledAt(1,b,a)},function(a){return c._settledAt(2,b,a)})},a}(),U=function(){function a(b){this[Q]=y(),this._result=this._state=void 0,this._subscribers=[],h!==b&&('function'!=typeof b&&B(),this instanceof a?x(this,b):C())}return a.prototype.catch=function(a){return this.then(null,a)},a.prototype.finally=function(a){var b=this,c=b.constructor;return b.then(function(b){return c.resolve(a()).then(function(){return b})},function(b){return c.resolve(a()).then(function(){throw b})})},a}();return U.prototype.then=f,U.all=function(a){return new T(this,a).promise},U.race=function(a){var b=this;return E(a)?new b(function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}):new b(function(a,b){return b(new TypeError('You must pass an array to race.'))})},U.resolve=g,U.reject=function(a){var b=this,c=new b(h);return s(c,a),c},U._setScheduler=function(a){H=a},U._setAsap=function(a){I=a},U._asap=I,U.polyfill=function(){var a;if('undefined'!=typeof global)a=global;else if('undefined'!=typeof self)a=self;else try{a=Function('return this')()}catch(a){throw new Error('polyfill failed because global object is unavailable in this environment')}var b=a.Promise;if(b){var c=null;try{c=Object.prototype.toString.call(b.resolve())}catch(a){}if('[object Promise]'===c&&!b.cast)return}a.Promise=U},U.Promise=U,U.polyfill(),U});
var wsiteFactory=function(){function e(e,t,i){return s=r[e]={dependencies:t,factory:i,exports:{},resolved:!1}}function t(e){if(!0!==e.resolved){e.resolved=!0;var i=e.dependencies.map(function(i){return"exports"===i?e.exports:function(){if(void 0!==r[i])return t(r[i]),r[i].exports;try{return require(i)}catch(t){throw Error("module '"+i+"' not found.")}}()});e.factory.apply(null,i)}}function i(){return Object.keys(r).map(function(e){return r[e]}).forEach(t),null===s?void 0:s.exports}var a=Math.min,n=Math.max,s=null,r={require:{factory:void 0,dependencies:[],exports:function(e,t){return require(e,t)},resolved:!0}};return e("helpers/helper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){if(this.on=!1,this.callBacks=new Map,i._instance)throw new Error("Error: Instantiation failed: Use COrientation.getInstance() instead of new.");this.orientation=this.getOrientation(),i._instance=this}static getInstance(){return i._instance}triggerEvents(){window.addEventListener("resize",t=>this.handleResize(t),!1)}onOrientationChange(e){this.on||(this.triggerEvents(),this.on=!0);let i=t.UUID();return this.callBacks.set(i,e),i}removeOrientationChange(e){this.callBacks.has(e)&&this.callBacks.delete(e)}handleResize(){clearTimeout(this.timer),this.timer=setTimeout(t=>this.reSize(t),i.time)}reSize(){if(this.getOrientation()!=this.orientation){let e=this.getOrientation();this.orientation=e,this.broadcast(e)}}broadcast(e){this.callBacks.forEach(t=>{t(e)})}getOrientation(){return window.outerWidth>window.outerHeight?i.landscape:i.portrait}}i.time=100,i.landscape="landscape",i.portrait="portrait",i._instance=new i,t.orientation=i.getInstance();class a{static dataMouseMove(e){let t=null;return t=e.getAttribute("data-mouse-move"),t}static dataClick(e){let t=null;return t=e.getAttribute("data-click"),t}static clickHandler(e){let t=e;for(;null!=t&&!a.dataClick(t);)t=t.parentElement;return t}static mouseMoveHandler(e){let t=e;for(;null!=t&&!a.dataMouseMove(t);)t=t.parentElement;return t}}t.CDom=a;class n{static repeat(e,t){let i=[];for(;0<t;)i.push(e);return i.join("")}static padStart(e,t,i){return t>>=0,i=("undefined"==typeof i?" ":i)+"",e.length>t?e+"":(t-=e.length,t>i.length&&(i+=n.repeat(i,t/i.length)),i.slice(0,t)+(e+""))}static split1Date(e){let t=e.split("-"),i={month:"",day:""};if(3==t.length)i.month=t[0]+"-"+t[1],i.day=t[2];else throw new Error("Error String.split1Date format (nnnn-nn-nn): value "+e);return i}static splitDate(e){let t=e.split("-"),i={year:0,month:0,day:0};if(3==t.length)i.year=parseInt(t[0],10),i.month=parseInt(t[1],10)-1,i.day=parseInt(t[2],10);else throw new Error("Error String.splitDate format (nnnn-nn-nn): value "+e);return i}}t.CString=n;class s{static getKey(e){let t=n.padStart(e.getMonth()+1+"",2,"0"),i=n.padStart(e.getDate()+"",2,"0");return e.getFullYear()+"-"+t+"-"+i}static getFrenchDay(e){let t=e.getDay(),i=0==t?7:t;return i--,i}static getFrenchFirstDay(e){let t=new Date(e.getFullYear(),e.getMonth(),1,4);return s.getFrenchDay(t)}static getFrenchWeekInMonth(e){return Math.floor((e.getDate()+s.getFrenchFirstDay(e)-1)/7)}}t.CDate=s,t.UUID=function(){return"sf_xxxxxxxx-xxxxxxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,e=>{var t=0|16*Math.random(),i="x"==e?t:8|3&t;return i.toString(16)})}}),e("calendar/view",["require","exports","helpers/helper"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this._container=e,this.monthsContainer=jQuery("<div class='sf-months-container'></div>")}get header(){return jQuery(["<div class=\"sf-calendar-buttons\">","<div class=\"sf-button-previous\" data-click=\"previous-group\"><i class=\"sf-icon-angle-double-left\"></i></div>","<div class=\"sf-button-previous-month\"  data-click=\"previous-month\"><i class=\"sf-icon-angle-left\"></i></div>","<div class=\"sf-button-next-month\"  data-click=\"next-month\"><i class=\"sf-icon-angle-right\"></i></div>","<div class=\"sf-button-next\"  data-click=\"next-group\"><i class=\"sf-icon-angle-double-right\"></i></div>","</div>"].join(""))}footer(e){let t=jQuery("<div class='sf-calendar-footer'></div>");for(let i in t.append("<div class='sf-calendar-legend'><div class='sf-rented sf-icon-legend'></div>Non disponible</div>"),t.append("<div class='sf-calendar-legend'><div class='sf-notinit sf-icon-legend'></div>Ferm\xE9</div>"),e){let a=`sf-${i}`;t.append(`<div class="sf-calendar-legend"><div class="${a} sf-icon-legend"></div>${e[i]}</div>`)}return t}get container(){return this._container}draw(e,t){this.container.append(this.header),this.container.append(this.monthsContainer),this.container.append(this.footer(t)),this.monthContentDraw(e)}monthContentDraw(e){for(let t in this.monthsContainer.empty(),e){let i=parseInt(t.split("-")[0],10),a=parseInt(t.split("-")[1],10);this.monthsContainer.append(this.buildMonth(i,a,e[t]))}}buildMonth(e,t,n){let i=this.monthLabel(e,t),s=jQuery("<div class=\"sf-layout-month\">");s.append("<div class=\"sf-header-month\">"+i+"</div>");let r=jQuery("<table class=\"sf-month-content\" cellspacing=\"0\"></div>");r.append("<tr><th>Lun</th><th>Mar</th><th>Mer</th><th>Jeu</th><th>Ven</th><th>Sam</th><th>Dim</th></tr>"),s.append(r);let o,d=-1,l=[],c=[];for(let s,r=n.length,h=0;h<r;h++)s=new Date(e,t-1,parseInt(n[h].day,10),4),d!=a.CDate.getFrenchWeekInMonth(s)&&(o="",l=this.initWeek(),c.push(l),d=a.CDate.getFrenchWeekInMonth(s)),o=parseInt(n[h].day,10)+"",l[a.CDate.getFrenchDay(s)+1]=this.htmlDay(o,n[h].data);for(;6>c.length;)c.push(this.initWeek());return r.append(jQuery(c.join(""))),s}initWeek(){return["<tr>",this.htmlDay("",{}),this.htmlDay("",{}),this.htmlDay("",{}),this.htmlDay("",{}),this.htmlDay("",{}),this.htmlDay("",{}),this.htmlDay("",{}),"</tr>"]}htmlDay(e,t){let i="",a="",n=t.rent&&!t.start||t.rent&&t.start&&t.end,s=t.rent&&!t.end||t.rent&&t.start&&t.end,r="sf-calendar-day-morning "+(n?"sf-rented":t.typeMorning),o="sf-calendar-day-afternoon "+(s?"sf-rented":t.typeAfternoon);return a=n&&s||" sf-notinit"==t.typeMorning&&" sf-notinit"==t.typeAfternoon?" sf-notfree":"",i=`<td class="sf-calendar-day${a}">`,i+=e,i+="<div class=\""+r+"\"></div>",i+="<div class=\""+o+"\"></div>",i+="</td>",i}monthLabel(e,t){return["Janvier","F&eacute;vrier","Mars","Avril","Mai","Juin","Juillet","Ao&ucirc;t","Septembre","Octobre","Novembre","D&eacute;cembre"][t-1]+" "+e}}t.CrView=i}),e("calendar/model",["require","exports","helpers/helper","helpers/helper"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t){this.dataid=e,this._dataRoot=t,this._periods=null,this._availabilities=null,this._data=null,this._lastKey=""}get lastKey(){return this._lastKey}getPeriods(e){let t=this;try{return new Promise((i,a)=>{t._periods?i():jQuery.getJSON(e,e=>{t._periods=e[t.dataid]||e,i()}).fail(()=>a("Periods"))})}catch(t){throw Error("Promise")}}getAvailabilities(e){let t=this;try{return new Promise((i,a)=>{t._availabilities?i():jQuery.getJSON(e,e=>{t._availabilities=e[t.dataid]||e,i()}).fail(()=>a("Availabilities"))})}catch(t){throw Error("Promise")}}getLegend(e){let t=this;try{return new Promise((i,a)=>{jQuery.getJSON(e,e=>{i(e[t.dataid]||e)}).fail(()=>a("Legend"))})}catch(t){throw Error("Promise")}}data(e,t){return this._data||(this._data={},this.buildPeriods(),this.buildAvailabilities()),this.dataReduce(e,t)}dataReduce(e,t){let n,s={},r=new Date(e.year,e.month,1,5),o=new Date(e.year,e.month+t,0,5),d=a.CDate.getKey(r),l=a.CDate.getKey(o);for(let a in this._data)a>=d&&a<=l&&(n=i.CString.split1Date(a),s[n.month]=s[n.month]||[],s[n.month].push({day:n.day,data:this._data[a]}));return s}get datas(){return this._data}buildPeriods(){let e=this,t="";for(let i in e._periods)e._periods[i].forEach(n=>{for(let s,r=new Date(parseInt(i,10),parseInt(n.start.split("-")[0],10)-1,parseInt(n.start.split("-")[1],10)),o=new Date(parseInt(i,10),parseInt(n.start.split("-")[0],10)-1,parseInt(n.start.split("-")[1],10)),d=new Date(parseInt(i,10),parseInt(n.end.split("-")[0],10)-1,parseInt(n.end.split("-")[1],10)),l=a.CDate.getKey(new Date);r.getTime()<=d.getTime();){s=a.CDate.getKey(r),s>t&&(t=s),e._data[s]=e._data[s]||{};let i=r.getTime()==o.getTime(),c=r.getTime()==d.getTime();s>l?(e._data[s].typeMorning=(e._data[s].typeMorning?e._data[s].typeMorning:"")+(!i||i&&c?" sf-"+n.type:""),e._data[s].typeAfternoon=(e._data[s].typeAfternoon?e._data[s].typeAfternoon:"")+(!c||i&&c?" sf-"+n.type:"")):(e._data[s].overDate=!0,e._data[s].rent=!0),r=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1)}});e._lastKey=t}buildAvailabilities(){let e=this;for(let t in e._availabilities)e._availabilities[t].forEach(i=>{let n=new Date(parseInt(t,10),parseInt(i.start.split("-")[0],10)-1,parseInt(i.start.split("-")[1],10)),s=new Date(parseInt(t,10),parseInt(i.end.split("-")[0],10)-1,parseInt(i.end.split("-")[1],10)),r=n;for(;n.getTime()<=s.getTime();){let t=a.CDate.getKey(n);e._data[t]=e._data[t]||{},e._data[t].rent=!0,e._data[t].overDate||(r.getTime()==n.getTime()&&(e._data[t].start=!0),s.getTime()==n.getTime()&&(e._data[t].end=!0)),n=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1)}})}}t.CrModel=n}),e("calendar/messages",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messagesfr={Header:"Le calendrier ne peut pas \xEAtre affich\xE9.",Promise:["Votre navigateur ne prend pas en charge certaines fonctionnalit\xE9s indispensables.","Merci d'utiliser un navigateur plus r\xE9cent."],Availabilities:["Disponibilit\xE9s non trouv\xE9es","V\xE9rifiez les param\xE8tres du composant (data-params)"],Periods:["Periodes non trouv\xE9es.","V\xE9rifiez les param\xE8tres du composant (data-params)"],Legend:["L\xE9gende non trouv\xE9e.","V\xE9rifiez les param\xE8tres du composant (data-params)"]}}),e("helpers/message",["require","exports","helpers/helper"],function(e,t,i){"use strict";function a(e){let t=void 0!==e&&null!==e&&void 0!==e.header&&null!==e.header&&"string"==typeof e.header,i=void 0!==e.message&&null!==e.message&&e.message instanceof Array;return t&&i}Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.$frame=jQuery(`<div class="sf-message-box"></div>`)}messsageBoxList(){let e=jQuery(".sf-message-box");return e}error(e,t){this.$frame.addClass("sf-error"),this.show(this.message(e,t))}info(e,t){this.$frame.addClass("sf-info"),this.show(this.message(e,t?new Error(t):void 0))}message(e,t){let i,n;return a(e)?n=e:(t=t||new Error("unknonwn"),i=e[t.message]||Array(t.message),n={header:e.Header,message:i}),n}show(e){let t=this.messsageBoxList().length;this.$frame.css("z-index",1e3+t);let i=this.header(e.header),a=jQuery(`<div class="sf-message-content"></div>`),n="";e.message.forEach(e=>{n+=`<div class="sf-message-line">${e}</div>`}),a.append(jQuery(n)),this.$frame.append(this.header(e.header)),this.$frame.append(a);let s=jQuery("body");s.append(this.$frame);let r=this.$frame.width()||0,o=s.width()||r;this.$frame.css("left",(o-r)/2+20*t+"px"),this.$frame.css("top",20+40*t+"px"),this.triggerEvent()}triggerEvent(){let e=this.$frame.get(0);e&&e.addEventListener("click",t=>this.click(t),!1)}click(t){let e=t.target;if(e=i.CDom.clickHandler(e),e)switch(i.CDom.dataClick(e)){case"message-close":this.destroy();}}header(e){let t=`<div class="sf-message-header"><div class="sf-message-title">${e}</div>`;return t+=`<div class="sf-close-popup" data-click="message-close"><i class="sf-icon-cancel"></i></div>`,t+=`</div>`,jQuery(t)}destroy(){let e=document.getElementById("sf-message");e&&e.removeEventListener("click",t=>this.click(t),!1),this.$frame.remove()}}t.CMessage=n,t.showError=function(e,t){new n().error(e,t)},t.showInfo=function(e){new n().info(e)}}),e("calendar/controller",["require","exports","calendar/view","calendar/model","calendar/messages","helpers/message","helpers/helper","helpers/helper","helpers/helper"],function(e,t,i,a,n,s,r,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class l{constructor(e,t){this.params=t,this.monthCount=t.monthCount,this.start={year:new Date().getFullYear(),month:new Date().getMonth()},this.model=new a.CrModel(t.dataid,t.dataRoot),this.view=new i.CrView(e),e.removeAttr("data-params")}previousGroup(){let e=new Date(this.start.year,this.start.month-this.monthCount,1,5);this.start=this.computePreviousStart(e),this.refresh()}previousMonth(){let e=new Date(this.start.year,this.start.month-1,1,5);this.start=this.computePreviousStart(e),this.refresh()}computePreviousStart(e){let t=new Date,i=e.getTime()<t.getTime()?t:e,a={year:0,month:0};return a.year=i.getFullYear(),a.month=i.getMonth(),a}nextGroup(){let e=new Date(this.start.year,this.start.month+this.monthCount,1,4);this.start=this.computeNextStart(e),this.refresh()}nextMonth(){let e=new Date(this.start.year,this.start.month+1,1,4);this.start=this.computeNextStart(e),this.refresh()}computeNextStart(e){let t={year:0,month:0},i=this.model.lastKey,a=r.CString.splitDate(i),n=new Date(a.year,a.month+1-this.monthCount,1,4),s=e.getTime()<n.getTime()?e:n;return t.year=s.getFullYear(),t.month=s.getMonth(),t}triggerEvents(){let e=this.view.container.get(0);e&&e.addEventListener("click",t=>this.click(t),!1)}click(t){let e=t.target;if(e=o.CDom.clickHandler(e),e)switch(o.CDom.dataClick(e)){case"previous-group":this.previousGroup();break;case"previous-month":this.previousMonth();break;case"next-month":this.nextMonth();break;case"next-group":this.nextGroup();}}dataLocation(e){let t=this.params.dataRoot;return`${t}${e}?${new Date().getTime()}`}show(){let e,t=this;try{t.model.getPeriods(this.dataLocation(this.params.periods)).then(()=>t.model.getAvailabilities(this.dataLocation(this.params.availabilities))).then(()=>(e=t.model.data(t.start,t.monthCount),t.model.getLegend(this.dataLocation(this.params.legend)))).then(i=>{t.view.draw(e,i),t.triggerEvents()}).catch(function(t){new s.CMessage().error(n.messagesfr,Error(t))})}catch(t){new s.CMessage().error(n.messagesfr,t)}}dayArrivalSelectable(e){let t=this.getDateConfigDay(e),i=!t.overDate&&(!t.rent||!t.start&&t.end),a=i?t.typeAfternoon:"";return[i,a,""]}dayDepartureSelectable(e){let t=this.getDateConfigDay(e),i=!t.overDate&&(!t.rent||!t.end&&t.start),a=i?t.typeMorning:"";return[i,a,""]}getDateConfigDay(e){let t=this.model.datas,i=d.CDate.getKey(e),a=t[i];return a}refresh(){let e=this.model.dataReduce(this.start,this.monthCount);this.view.monthContentDraw(e)}}t.CrCalendar=l,t.calendarFactory=function(){jQuery(".sf-calendar").each((e,t)=>{let i=jQuery(t),a=i.data("params"),n=new l(i,a);n.show()})},t.calendar=function(e){let t=jQuery(`#${e}`);if(0==t.length)return null;let i=t.data("params"),a=new l(t,i);return a.show(),a}}),e("slideShow/model",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this._data=[],this._imageRoot=e}requestdata(e,t,i){let a=this;try{return new Promise((n,s)=>{a.updateData(n,s,e,t,i)})}catch(t){throw Error("Promise")}}updateData(e,t,i,a,n){let s=this;a?jQuery.getJSON(a+"?"+new Date().getTime(),t=>{s._data=i?s.setImagesUrl(t[i]):s.setImagesUrl(t),e(s.data)}).fail(()=>t("slideShow")):n?s._data=i?s.setImagesUrl(n[i]):s.setImagesUrl(n):t("slideShow")}get data(){return this._data}get length(){return this.data.length}setImagesUrl(e){var t=this;return e.map(e=>(e.url=t._imageRoot+e.name,e))}}t.CSModel=i}),e("slideShow/view",["require","exports"],function(e,t){"use strict";var i=Math.abs;Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this._$container=e,this._$slide=jQuery(""),this._$thumbnails=jQuery(""),this._$thumbnailContainer=jQuery(""),this._$thumbnailsRow=jQuery(""),this._params={showCaption:!0,showThumbnail:!0,current:0}}draw(e,t){if(this._$slide.empty(),this._$thumbnails.empty(),this._params=e,this._$slide=this.buildSlide(t[this._params.current],this._params.current,t.length,this._params.showCaption),this._$container.append(this._$slide),this._params.showThumbnail){this._$thumbnails=this.buildThumbnails(this._params.current,t),this._$container.append(this._$thumbnails);let e=jQuery(".sf-slide-thumbnail-column",this._$thumbnailsRow),i=e.width()||0;this._$thumbnailsRow.width(i*t.length+2*t.length)}}get container(){return this._$container}getThumbnailPosition(e){return jQuery(`.sf-slide-thumbnail-column[data-index="${e}"]`,this._$thumbnails).position().left}getThumbnailWidth(e){return jQuery(`.sf-slide-thumbnail-column[data-index="${e}"]`,this._$thumbnails).width()||0}isThumbnailVisible(e){let t=!0,a=this.getThumbnailPosition(e),n=this.getThumbnailWidth(e);return(a<i(this.rowLeft)||a+n>i(this.rowLeft)+this.containerWidth)&&(t=!1),t}showThumbNail(e){if(this._params.showThumbnail&&!this.isThumbnailVisible(e)){let t=n(this.centerThumbnail(e),0);return t=a(t,this.rowWidth-this.containerWidth),this.rowLeft=-t,-t}return this.rowLeft}centerThumbnail(e){let t=this.getThumbnailPosition(e),i=this.getThumbnailWidth(e);return t=t+i/2-this.containerWidth/2,t}moveThumbNails(e){if(!this._params.showThumbnail)return 0;let t=this.containerWidth,a=this.rowLeft,n=0;return e?(i(a)+t+this.containerWidth>this.rowWidth&&(t=this.rowWidth+a-this.containerWidth),n=a-t):(0<=a+t&&(a=0,t=0),n=a+t),this.rowLeft=n,n}refresh(e,t,i){let a=this._params.showCaption,n=this._params.showThumbnail,s=jQuery("img.sf-img-slide-0",this._$slide),r=jQuery("img.sf-img-slide-1",this._$slide),o=s,d=r;"0"==s.css("opacity")&&(o=r,d=s),d.attr("src",e.url),d.css("opacity",1),o.css("opacity",0),jQuery(".sf-numbertext",this._$slide).html(this.formatNumberText(i,t)),a&&jQuery(".sf-slide-caption",this._$slide).html(e.caption),n&&(jQuery(".sf-slide-thumbnail-column",this._$thumbnails).removeClass("sf-current"),jQuery(`.sf-slide-thumbnail-column[data-index="${i}"]`,this._$thumbnails).addClass("sf-current"))}buildSlide(e,t,i,a){let n=`<div class="sf-slide">${this.slideContent(e,t,i,a)}</div>`;return jQuery(n)}formatNumberText(e,t){return`${e+1}/${t}`}slideContent(e,t,i,a){let n=`<div class="sf-img-container-slide"><img class="sf-img-slide-0" src="${e.url}">`;return n+=`<img style="opacity:0" class="sf-img-slide-1" src="${e.url}"></div>`,n+=`<div class="sf-numbertext">${this.formatNumberText(t,i)}</div>`,n+=`<div class="sf-slide-btn-left" data-click="slide-left" style="visibility:hidden"></div>`,n+=`<div class="sf-slide-btn-right" data-click="slide-right" style="visibility:hidden"></div>`,a&&(n+=`<div class="sf-slide-caption">${e.caption}</div>`),n}buildThumbnails(e,t){let i=this,a=jQuery("<div class=\"sf-thumbnail\"></div>");return a.append(this.thumbnailButtons()),this._$thumbnailContainer=jQuery("<div class=\"sf-thumbnail-container\"></div>"),this._$thumbnailsRow=jQuery("<div class=\"sf-slide-thunbnail-row\"></div>"),t.forEach((t,a)=>{i._$thumbnailsRow.append(i.buildThumbnail(t,a,e))}),this._$thumbnailContainer.append(i._$thumbnailsRow),a.append(this._$thumbnailContainer),a}get rowWidth(){return this._params.showThumbnail?this._$thumbnailsRow.width()||0:0}get rowLeft(){if(!this._params.showThumbnail)return 0;let e=parseFloat(this._$thumbnailsRow.css("left"));return 0>e&&(e-=.01),e}set rowLeft(e){this._params.showThumbnail&&this._$thumbnailsRow.css("left",e+"px")}get containerWidth(){return this._params.showThumbnail?this._$thumbnailContainer.width()||0:0}buildThumbnail(e,t,i){let a=`<div class="sf-slide-thumbnail-column ${i==t?"current":""}"`;return a+=` data-click="thumbnail" data-index=${t} title="${e.caption}" alt="${e.caption}"`,a+=` style="background-image:url(${e.url})">`,jQuery(a)}thumbnailButtons(){let e="<div class=\"sf-thumbnail-btns\">";return e+="<div class=\"sf-thumbnail-btn-left\" data-click=\"thumbnails-left\" style=\"visibility:hidden\"><i class=\"sf-icon-angle-left\"></i></div>",e+="<div class=\"sf-thumbnail-btn-right\" data-click=\"thumbnails-right\" style=\"visibility:hidden\"><i class=\"sf-icon-angle-right\"></i></div>",e+="</div>",jQuery(e)}thumbnailBtnsVisibility(e,t){this._params.showThumbnail&&(jQuery(".sf-thumbnail-btn-left",this._$thumbnails).css("visibility",e),jQuery(".sf-thumbnail-btn-right",this._$thumbnails).css("visibility",t))}slideBtnsVisibility(e,t){jQuery(".sf-slide-btn-left",this._$slide).css("visibility",e),jQuery(".sf-slide-btn-right",this._$slide).css("visibility",t)}}t.CSlideView=s}),e("slideShow/messages",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messagesfr={Header:"Le slider ne peut pas \xEAtre affich\xE9.",Promise:["Votre navigateur ne prend pas en charge certaines fonctionnalit\xE9s indispensables.","Merci d'utiliser un navigateur plus r\xE9cent."],slideShow:["Impossible de trouver la liste des images \xE0 afficher.","V\xE9rifiez les param\xE8tres du composant (data-params)"]}}),e("slideShow/controller",["require","exports","slideShow/view","slideShow/model","slideShow/messages","helpers/message","helpers/helper"],function(e,t,i,s,r,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class l{constructor(e,t){this._currentIndex=0,this._id=e.attr("id")||"",this._params=t,this._view=new i.CSlideView(e),this._model=new s.CSModel(this._params.imageRoot),e.removeAttr("data-params")}triggerEvents(){let e=this._view.container.get(0);e&&e.addEventListener("click",t=>this.click(t),!1)}click(t){let e=t.target;if(e=d.CDom.clickHandler(e),e)switch(d.CDom.dataClick(e)){case"slide-left":this.clickSlideBtns(-1);break;case"slide-right":this.clickSlideBtns(1);break;case"thumbnails-right":this.clickThumbernailBtns(!0);break;case"thumbnails-left":this.clickThumbernailBtns(!1);break;case"thumbnail":this.clickThumbnail(parseInt(e.getAttribute("data-index")||"0",10));}}clickSlideBtns(e){let t=this,i=t._currentIndex;i+=e,t.changeSlide(i);let a=t._view.showThumbNail(i);t.btnsState(a)}clickThumbnail(e){let t=this;t.changeSlide(e),t.btnsState(t._view.rowLeft)}clickThumbernailBtns(e){let t=this,i=0;i=t._view.moveThumbNails(e),t.btnsState(i)}btnsState(e){let t=0<=e?"hidden":"visible",i=-e+this._view.containerWidth>=this._view.rowWidth?"hidden":"visible";this._view.thumbnailBtnsVisibility(t,i),t=0==this._currentIndex?"hidden":"visible",i=this._currentIndex==this._model.length-1?"hidden":"visible",this._view.slideBtnsVisibility(t,i)}changeSlide(e){this._currentIndex=n(e,0)&&a(e,this._model.length-1),this._view.refresh(this._model.data[this._currentIndex],this._model.length,this._currentIndex)}show(){let e=this;try{e._model.requestdata(e._params.dataid,e._params.dataLocation).then(t=>{let i={current:0,showThumbnail:e._params.showThumbnail,showCaption:e._params.showCaption};e._view.draw(i,t),e.triggerEvents(),e.btnsState(0)}).catch(function(t){new o.CMessage().error(r.messagesfr,Error(t))})}catch(t){new o.CMessage().error(r.messagesfr,t)}}}t.CSlideShow=l,t.slideShowFactory=function(){jQuery(".sf-slideShow").each((e,t)=>{let i=jQuery(t),a=i.data("params"),n=new l(i,a);n.show()})},t.slideShow=function(e){let t=jQuery(`#${e}`);if(0<t.length){let e=t.data("params"),i=new l(t,e);i.show()}}}),e("tabsection/controller",["require","exports","helpers/helper"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class a{constructor(e,t){this.$sectionList=jQuery(`.${t}`),this.$container=jQuery(`<div class="${t}-tabs"></div>`)}get list(){return this.$sectionList}get container(){return this.$container}triggerEvents(){this.container.get(0).addEventListener("click",t=>this.click(t),!1)}click(t){let e=t.target;e=i.CDom.clickHandler(e),e&&this.doClick(e)}doClick(e){"tab"===i.CDom.dataClick(e)&&this.clickTab(jQuery(e).data("index"))}clickTab(e){let t=parseInt(e,10)||0,i=jQuery(this.list[t]),a=parseInt(i.css("margin-top"),10)+parseInt(i.css("padding-top"),10),n=i.offset(),s=(this.container&&this.container.height()||0)+6;this.scrollTo(n.top-s+a-2)}scrollTo(e){jQuery("body, html").animate({scrollTop:e},700)}}class s extends a{constructor(e,t="sf-panel"){if(super(e,t),this.panelClosed=!1,this.buttonSize=30,this.linkSizeMin=90,this.top=0,1<=this.$sectionList.length){jQuery(document.body).append(this.container);let i=this.getParams(e);this.linkSizeMin=i.minSize;let a=this.buildTabs(t,i);this.container.append(a),this.top=(this.container&&this.container.height()||0)+6;let n=this.paddingRight(a,i.scrollTop,i.close);a.css("padding-right",`${n}px`),this.triggerEvents()}this.scroll()}buildTabs(e,t){let i="",a=this.widths(),n=0,s="";this.buttonSize&&(s=`style="width:${this.buttonSize}px" `),this.list.each((t,s)=>{let r=this.caption(s);i+=this.link(e,r,t,a),n=t}),t.scrollTop&&(n++,i+=`<li class="${e}-tab sf-btn-panel" ${s} data-click="scrollTop"><span style="width:${this.buttonSize}px" class="sf-tab-scrollTop sf-icon-up-circled"></span></li>`),t.close&&(n++,i+=`<li class="${e}-tab sf-btn-panel" ${s} data-click="close"><span style="width:${this.buttonSize}px" class="sf-tab-close sf-icon-cancel-circled"></span></li>`);let r=`<div class="${e}-tabs-panel"><ul class="sf-tabs">${i}</ul></div>`;return jQuery(r)}link(e,t,i,a){let n="",s="",r="";return s=`style="width:${100*a.width[i]/a.total}%"`,r=`style="width:${a.width[i]}px"`,n=`<li class="${e}-tab" ${s} data-click="tab" data-index="${i}"><span ${r} class="sf-tab-text">${t}</span></li>`,n}getParams(e){let t={scrollTop:!1,close:!1,minSize:this.linkSizeMin,css:""};return e&&(t.scrollTop=!!e&&e.scrollTop,t.close=!!e&&e.close,t.minSize=e.minSize?e.minSize:this.linkSizeMin),t}triggerEvents(){super.triggerEvents(),window.addEventListener("scroll",()=>this.scroll(),!1)}doClick(e){switch(super.doClick(e),i.CDom.dataClick(e)){case"close":this.panelClosed=!0,this.hide();break;case"scrollTop":this.scrollTo(0);}}caption(e){let t=jQuery(e),i=t.data("params")?t.data("params").caption||t.text():t.text();return i}scroll(){20<document.body.scrollTop||20<document.documentElement.scrollTop?!this.panelClosed&&this.show():(this.panelClosed=!1,this.hide())}widths(){let e={width:[],total:0};return this.list.each((t,i)=>{let a=jQuery(i),n=a.data("params")?a.data("params").caption||a.text():a.text();e.width.push(this.captionSize(n)),e.total+=e.width[t]}),e}paddingRight(e,t,i){let a=parseInt(e.css("padding-left"),10)+this.$sectionList.length-1;return t&&(a+=this.buttonSize+1),i&&(a+=this.buttonSize+1),a}captionSize(e){let t=jQuery(`<span id="sf-sizing"style="width:auto;box-sizing: border-box;" class="sf-tab-text">${e}</span>`);jQuery(document.body).append(t);let i=n((t.width()||0)+2,this.linkSizeMin);return t.remove(),i}hide(){0<=this.container.position().top&&(this.container.get(0).style.top=`-${this.top}px`)}show(){0>this.container.position().top&&(this.container.get(0).style.top=`0px`)}}class r extends a{constructor(e,t,i="sf-link"){if(super(t,i),1<=this.$sectionList.length){let e=this.buildTabs(i,t);this.container.append(e),this.triggerEvents()}jQuery(document.body).append(this.container);let a=jQuery(e);0<a.length&&(a.css("position","relative"),a.append(this.container))}buildTabs(e){let t="",i=0;this.list.each((a,n)=>{let s=this.caption(n);t+=this.link(e,s,a,this.highlight(n)),i=a});let a=`<div class="${e}-tabs-panel"><ul class="sf-tabs">${t}</ul></div>`;return jQuery(a)}link(e,t,i,a){let n="",s=a?" sf-highlight":"";return n=`<li class="${e}-tab" data-click="tab" data-index="${i}"><span class="sf-tab-text${s}">${t}<span class="sf-icon-level-down"></span></span></li>`,n}caption(e){let t=jQuery(e),i=t.data("params")?t.data("params").captionLink||t.text():t.text();return i}highlight(e){let t=jQuery(e),i=!!t.data("params")&&t.data("params").highlight;return i}}t.panelSectionFactory=function(e){new s(e)},t.linkSectionFactory=function(e,t){let i=t.position.split(",").join("-"),a=new r(e,t);a.container.addClass(`sf-${i}`)}}),e("imageZoom/controller",["require","exports"],function(e,t){"use strict";function i(e,t,i){let a=t||e;0<a.length&&a.get(0).addEventListener("click",()=>s.getInstance().zoom(e,i),!1)}function n(e,t,a){let n=null;if(!t){let t=jQuery(`<div class="sf-frame-image"></i></div>`);n=jQuery(`<span class="sf-zoom-open"><i class="sf-icon-resize-full-2"></i></span>`),t.append(n),t.insertBefore(e),e.appendTo(t)}i(e,n,a)}Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(){if(this.$container=null,this.$frame=null,this.$btnClose=null,s._instance)throw new Error("Error: Instantiation failed: Use CImgZoom.getInstance() instead of new.");s._instance=this}static getInstance(){return s._instance}zoom(e,t){let i=this;this.$container&&this.destroy(),e&&this.promiseImageSizes(e).then(n=>{i.$container=i.mainContainer(),i.$frame=i.frame(t?a(n.width,t):n.width),this.$btnClose=i.closeButton(),i.$frame.append(this.$btnClose),i.$frame.append(i.cloneCleanImage(e)),i.$container.append(i.$frame);let s=jQuery("body");s.append(i.$container),setTimeout(()=>{i.$frame&&i.$frame.css("opacity",1)},50)})}mainContainer(){return jQuery(`<div class="sf-imgzoom-container"></div>`)}frame(e){let t=jQuery(`<div class="sf-image-frame"></div>`);return t.css("max-width",`${e}px`),t.css("opacity",0),t}closeButton(){let e=jQuery(`<div class="sf-close-zoom" data-click="zoom-close"><span class="sf-close-zoom-btn sf-icon-cancel "></span></div>`);return e.get(0).addEventListener("click",t=>this.close(t),!1),e}cloneCleanImage(e){let t=e.clone();return t.removeAttr("height").removeAttr("width").removeAttr("sizes").removeClass(),t.addClass("sf-zoom-image"),t}promiseImageSizes(e){this;try{return new Promise((t,i)=>{let a=new Image;a.src=e.attr("src"),a.onload=()=>t({width:a.width,height:a.height}),a.onerror=()=>i("image")})}catch(t){throw Error("Promise")}}close(){this.$frame&&this.$frame.css("opacity",0),setTimeout(()=>this.destroy(),1e3)}destroy(){this.$frame&&this.$frame.remove(),this.$container&&(this.$btnClose.get(0).removeEventListener("click",t=>this.close(t),!1),this.$container.remove()),this.$container=null,this.$frame=null}}s._instance=new s,t.imageZoomFactory=function(e){jQuery(".sf-imgZoom").each((t,i)=>{let a=jQuery(i),s=a.hasClass("sf-noicon");n(a,s,e)})}}),e("listes/controller",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.$list=jQuery(`.sf-hierarchy.${e}`),this.$li=jQuery("li",this.$list),this.setLiContainer()}setLiContainer(){}}class a extends i{constructor(e){super(e)}setLiContainer(){this.$li.has("ul").addClass("sf-icon-folder-open sf-container"),jQuery("li:not(:has(ul))",this.$list).addClass("sf-icon-doc sf-contents")}}t.listFolder=function(){new a("sf-type-folder")}}),e("responsiveTopnav/controller",["require","exports","helpers/helper"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class a{constructor(e,t){this.$menu=e,this.$menu.addClass(t?`sf-${t}`:""),this.addIcon()}addIcon(){this.$menu.append(this.getModel(this.$menu.is(`ul`))),this.triggerEvents()}getModel(e){let t=`<a  href="javascript:void(0)" class="sf-icon-menu" data-click="menuIcon"></a>`,i=e?`<li class="sf-icon-menu-container">${"<a  href=\"javascript:void(0)\" class=\"sf-icon-menu\" data-click=\"menuIcon\"></a>"}</li>`:`${"<a  href=\"javascript:void(0)\" class=\"sf-icon-menu\" data-click=\"menuIcon\"></a>"}`;return i}triggerEvents(){this.$menu.get(0).addEventListener("click",t=>this.click(t),!1)}click(t){let e=t.target;e=i.CDom.clickHandler(e),e&&this.doClick(e)}doClick(e){"menuIcon"===i.CDom.dataClick(e)&&this.clickResponsive()}clickResponsive(){this.$menu.toggleClass(`sf-responsive`)}}t.responsiveTopNavFactory=function(e){jQuery(`.sf-responsive-topnav`).each((t,i)=>{new a(jQuery(i),e)})},t.responsiveTopNav=function(e,t){let i=jQuery(e).addClass("sf-responsive-topnav");new a(i,t)}}),e("imageDetail/view",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CImageDetailView=class{constructor(){}draw(e,t,i,n){this.$detail=jQuery(`<div class="sf-img-detail-result" style="background-image:url('${e.src}')"></div>`),this.$image=jQuery(`<div class="sf-img-detail-image" data-mouse-move="move-image"></div>`),this.$square=jQuery(`<div class="sf-img-detail-square" data-mouse-move="move-square"></div>`),this.$image.append(this.$square),this.$image.append(`<img style="max-height:${i}px" src="${e.src}">`),this.$btnclose=jQuery(`<div class="sf-close-img-detail" data-click="img-detail-close"><span class="sf-close-img-detail-btn sf-icon-cancel "></span></div>`);let s=jQuery(`<div class="sf-img-detail-frame" style="max-width:${t}px"></div>`);this.$container=jQuery(`<div class="sf-img-detail-container"></div>`),s.append(this.$btnclose),s.append(this.$image),s.append(this.$detail),this.$container.append(s);let r=jQuery("body");r.append(this.$container);let o=a(s.width(),n);s.width(`${o}%`)}squareOffset(){let e={width:0,height:0,width:this.$square.get(0).offsetWidth,height:this.$square.get(0).offsetHeight};return e}squareSizes(e){let t=e||{width:0,height:0};return e?(this.$square.width(e.width),this.$square.height(e.height)):(t.width=this.$square.width(),t.height=this.$square.height()),t}squarePosition(e){let t=e||{left:0,top:0};return e?(this.$square.get(0).style.left=e.left+"px",this.$square.get(0).style.top=e.top+"px"):t=this.$square.position(),t}imageSizes(e){let t=e||{width:0,height:0};return e?(this.$image.width(t.width),this.$image.height(t.height)):(t.width=this.$image.width(),t.height=this.$image.height()),t}imagePosition(){return this.$image.get(0).getBoundingClientRect()}resultOffset(){let e={width:0,height:0,width:this.$detail.get(0).offsetWidth,height:this.$detail.get(0).offsetHeight};return e}resultBackGroundPosition(e,t){this.$detail.get(0).style.backgroundPosition=`-${e}px -${t}px`}resultBackGroundSize(e,t){this.$detail.get(0).style.backgroundSize=`${e}px ${t}px`}destroy(){this.$container&&(this.$container.empty(),this.$container.remove())}}}),e("imageDetail/controller",["require","exports","helpers/helper","imageDetail/view","helpers/helper"],function(e,t,i,s,r){"use strict";function o(e,t,i){let a=t||e,n=e.data("detail")||e.attr("src"),s=new Image;s.src=n,0<a.length&&a.get(0).addEventListener("click",()=>l.getInstance().zoom(n,i),!1)}function d(e,t,i){let a=null;if(!t){let t=jQuery(`<div class="sf-frame-imgDetail"></i></div>`);a=jQuery(`<span class="sf-imgDetail-open"><i class="sf-icon-resize-full-2"></i></span>`),t.append(a),t.insertBefore(e),e.appendTo(t)}o(e,a,i)}Object.defineProperty(t,"__esModule",{value:!0});class l{constructor(){if(this.ratio={cx:0,cy:0},this.imageUrl="",l._instance)throw new Error("Error: Instantiation failed: Use CImageDetail.getInstance() instead of new.");l._instance=this,this.orientation=r.orientation.onOrientationChange(e=>this.orientationChange(e))}test(e){console.log(`test ${e}`)}orientationChange(){console.log(`Orientationchange CImageDetail${this.imageUrl}`),""!=this.imageUrl&&(console.log("zoom auto"),this.zoom(this.imageUrl,this.width))}static getInstance(){return l._instance}zoom(e,t){this.destroy(),this.view=new s.CImageDetailView,this.imageUrl=e,this.width=t;let i=this;this.promiseImage(e).then(e=>{i.view.draw(e,i.width,i.maxHeight(),i.frameWidth(e,i.width)),i.zoomLimit(i.view.imageSizes()),i.setRation(),i.triggerEvents()})}frameWidth(e){if(e.height<=this.maxHeight())return 97;let t=this.maxHeight()/e.height,i=e.width*t,n=100*(2*i)/window.innerWidth;return a(n,97)}maxHeight(){return window.innerHeight-20*window.innerHeight/100}promiseImage(e){this;try{return new Promise((t,i)=>{let a=new Image;a.src=e,a.onload=()=>t(a),a.onerror=()=>i("image")})}catch(t){throw Error("Promise")}}zoomLimit(e){let t=n(parseInt(e.width,10),parseInt(e.height,10)),i=t/10;this.view.squareSizes({width:i,height:i})}setRation(){let e=this.view.squareOffset(),t=this.view.resultOffset(),i=this.view.imageSizes();this.ratio.cx=t.width/e.width,this.ratio.cy=t.height/e.height,this.view.resultBackGroundSize(parseInt(i.width,10)*this.ratio.cx,parseInt(i.height,10)*this.ratio.cy)}triggerEvents(){this.view.$container.get(0).addEventListener("click",t=>this.handleClick(t),!1),this.view.$container.get(0).addEventListener("mousemove",t=>this.handleMouseMove(t),!1),this.view.$container.get(0).addEventListener("touchmove",t=>this.handleMouseMove(t),!1)}handleMouseMove(t){let e=t.target;if(e=i.CDom.mouseMoveHandler(e),e)switch(i.CDom.dataMouseMove(e)){case"move-square":case"move-image":this.moveSquare(t);}}handleClick(t){let e=t.target;if(e=i.CDom.clickHandler(e),e)switch(i.CDom.dataClick(e)){case"img-detail-close":this.close();}}close(){this.destroy()}destroy(){this.imageUrl="",this.width=void 0,this.view&&(this.view.$container.get(0).removeEventListener("click",t=>this.handleClick(t),!1),this.view.$container.get(0).removeEventListener("mousemove",t=>this.handleMouseMove(t),!1),this.view.$container.get(0).removeEventListener("touchmove",t=>this.handleMouseMove(t),!1),this.view.destroy(),this.view=null)}moveSquare(t){let e,i,a,n,s;t.preventDefault(),e=this.getCursorPos(t),i=this.view.squareOffset(),a=this.view.imageSizes();let r=parseInt(a.width,10),o=parseInt(a.height,10);n=e.x-i.width/2,s=e.y-i.height/2,n>r-i.width&&(n=r-i.width),0>n&&(n=0),s>o-i.height&&(s=o-i.height),0>s&&(s=0),this.view.squarePosition({left:n,top:s}),this.view.resultBackGroundPosition(n*this.ratio.cx,s*this.ratio.cy)}getCursorPos(t){let e,i,n,s={x:0,y:0},r=t||window.event;return e=this.view.imagePosition(),i=r.pageX-e.left,n=r.pageY-e.top,s.x=i-window.pageXOffset,s.y=n-window.pageYOffset,s}}l._instance=new l,t.imageDetailFactory=function(e){jQuery(".sf-imgDetail").each((t,i)=>{let a=jQuery(i),n=a.hasClass("sf-noicon");d(a,n,e)})}}),e("w-siteFactory",["require","exports","calendar/controller","slideShow/controller","helpers/message","tabsection/controller","imageZoom/controller","listes/controller","responsiveTopnav/controller","imageDetail/controller"],function(e,t,i,a,n,s,r,o,d,l){"use strict";function c(e,t){n.showError(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.calendarFactory=function(){i.calendarFactory()},t.calendar=function(e){return i.calendar(e)},t.slideShowFactory=function(){a.slideShowFactory()},t.slideShow=function(e){a.slideShow(e)},t.info=function(e){n.showInfo(e)},t.error=c,t.panelSectionFactory=function(e){s.panelSectionFactory(e)},t.linkSectionFactory=function(e,t){let i=t||{postion:"center,center"};i.position=i.position?i.position:"center,center",s.linkSectionFactory(e,i)},t.imageZoomFactory=function(e){r.imageZoomFactory(e)},t.listFolder=function(){o.listFolder()},t.responsiveTopNavFactory=function(e){d.responsiveTopNavFactory(e)},t.responsiveTopNav=function(e,t){d.responsiveTopNav(e,t)},t.imageDetailFactory=function(e){l.imageDetailFactory(e)}}),i()}();

